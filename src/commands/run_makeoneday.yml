description: "Run makeoneday script"

parameters:
  repo:
    description: "Name of repository"
    type: string
    default: GEOSgcm
  workspace_root:
    description: "Root of workspace"
    type: string
    default: workspace
  gcm_experiment_name:
    description: "Name of experiment"
    type: string
    default: test-gcm

steps:
  - run:
      name: "Run makeoneday"
      command: |
        cd ${CIRCLE_WORKING_DIRECTORY}/<< parameters.workspace_root >>/<< parameters.gcm_experiment_name >>
        /TinyBCs-GitV10/scripts/makeoneday.bash 1hr nxy 1 6 noext
      name: "Set geosgcm_prog history to 1 hour frequency"
      command: |
        cd ${CIRCLE_WORKING_DIRECTORY}/<< parameters.workspace_root >>/<< parameters.gcm_experiment_name >>
        sed -i.bak '/geosgcm_prog.frequency/ s/6/1/' HISTORY.rc
